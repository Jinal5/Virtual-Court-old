clear; clc; clf;

data=[235    4.005    0.02

276    3.654    0.0025

300    3.654    0.0025

345    4.293    0.078

334    4.293    0.078

235    4.293    0.078

569    4.53    0.3495

360    4.271    0.06325

475    4.271    0.06325

348    4.271    0.06325

295    4.092    0.194

355    4.431    0.0835

385    4.431    0.0835

350    4.698    0.08525

474    5.054    0.1815

575    5.067    0.04225

675    4.653    0.43

290    3.735    0.0005

290    3.735    0.0005

472    5.034    0.0465

345    4.282    0.01625

340    4.282    0.01625

350    4.282    0.01625

370    4.57    0.25225

489    5.13    0.0705

515    5.13    0.0705

310    4.284    0.0005

322    4.284    0.0005

335    4.284    0.0005

475    4.733    0.434

325    4.092    0.0625

280    3.943    0.0305

295    3.943    0.0305

395    3.224    0

300    3.224    0

350    3.549    0.025

510    4.466    0.209

285    3.642    0.044

285    3.691    0.0395

340    3.691    0.0395

334    3.691    0.0395

320    4.284    0.17375

295    4.284    0.17375

370    4.284    0.17375

499    4.727    0.375

590    4.819    0.41225

230    3.502    0.1075

275    3.586    0.0055

358    4.29    0.10125

354    4.29    0.10125

315    3.854    0.24575

365    4.278    0.03925

385    4.503    0.03575

400    4.503    0.03575

410    4.503    0.03575

355    4.011    0.09

510    4.556    0.18475

470    4.646    0.17325

398    4.71    0.258

390    4.71    0.258

629    4.873    0.25075

350    3.94    0

205    3.94    0

240    3.871    0.0125

317    3.977    0.05675

330    4.254    0.03175];

 

z = data(:,1); y = data(:,2); x = data(:,3);

 

Xcolv = x(:); Ycolv = y(:); Zcolv = z(:);

Const = ones(size(Xcolv)); % Vector of ones for constant term

 

Coefficients = [Xcolv Ycolv Const]\Zcolv; % Find the coefficients

XCoeff = Coefficients(1); YCoeff = Coefficients(2); CCoeff = Coefficients(3);

 

% scatter3(x, y, z, 'filled'); hold on;

h = plot3(x,y,z,'.')

 

set(h,'markersize',40)

xlabel('Prob(Loss)'); ylabel('Duration'); zlabel('Spread to Swaps');

axis([0 0.5 3 6 200 700]);

 

 

[xx, yy] = meshgrid(0:0.01:0.5,3:0.1:6); % Generating a regular grid for plotting

zz = XCoeff * xx + YCoeff * yy + CCoeff;

hold on;

h = mesh(xx,yy,zz);

 

set(h, 'FaceColor', 'w');

set(h, 'EdgeColor', 'g');

alpha(0.7)